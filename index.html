<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Trance Studio - Ultra Pro Edition</title>
    <style>
        :root {
            --neon-blue: #00f2ff;
            --neon-purple: #bc13fe;
            --neon-green: #39ff14;
            --bg-dark: #020205;
            --panel-bg: #0d0d16;
            --border-glow: rgba(0, 242, 255, 0.3);
        }

        body {
            background-color: var(--bg-dark);
            color: #e0e0e0;
            font-family: 'Inter', 'Segoe UI', system-ui, sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
        }

        .studio-wrapper {
            width: 98%;
            max-width: 1600px;
            padding: 20px;
        }

        header {
            text-align: center;
            padding: 40px 0;
            border-bottom: 1px solid #222;
            margin-bottom: 30px;
        }

        h1 {
            font-size: 3.5rem;
            background: linear-gradient(135deg, var(--neon-blue), var(--neon-purple), var(--neon-green));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-transform: uppercase;
            letter-spacing: 8px;
            filter: drop-shadow(0 0 15px rgba(0, 242, 255, 0.4));
        }

        /* Dashboard Layout */
        .dashboard {
            display: grid;
            grid-template-columns: 350px 1fr;
            gap: 25px;
        }

        .sidebar {
            background: var(--panel-bg);
            border-radius: 20px;
            padding: 25px;
            border: 1px solid #222;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        .main-stage {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }

        .card {
            background: var(--panel-bg);
            border-radius: 20px;
            padding: 25px;
            border: 1px solid #222;
        }

        /* Controls */
        .input-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 10px;
            font-size: 0.9rem;
            color: var(--neon-blue);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        input[type="text"], input[type="password"], textarea, select {
            width: 100%;
            background: #000;
            border: 1px solid #333;
            color: #fff;
            padding: 12px;
            border-radius: 10px;
            box-sizing: border-box;
            font-family: inherit;
        }

        textarea { height: 120px; resize: none; }

        .btn {
            width: 100%;
            padding: 15px;
            border: none;
            border-radius: 12px;
            font-weight: 800;
            cursor: pointer;
            text-transform: uppercase;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .btn-primary { background: var(--neon-blue); color: #000; }
        .btn-secondary { background: var(--neon-purple); color: #fff; }
        .btn-danger { background: #ff4444; color: #fff; }
        .btn-success { background: var(--neon-green); color: #000; }

        .btn:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 5px 20px rgba(0, 242, 255, 0.4);
        }

        .btn:disabled { opacity: 0.2; cursor: not-allowed; }

        /* Mixer UI */
        .mixer-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(110px, 1fr));
            gap: 15px;
        }

        .mixer-strip {
            background: #08080c;
            border: 1px solid #1a1a25;
            border-radius: 15px;
            padding: 15px 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .fader-container {
            height: 150px;
            width: 30px;
            background: #111;
            border-radius: 5px;
            position: relative;
        }

        .fader {
            -webkit-appearance: slider-vertical;
            width: 100%;
            height: 100%;
            background: transparent;
        }

        .meter {
            width: 8px;
            height: 100%;
            background: #111;
            border-radius: 4px;
            overflow: hidden;
            position: relative;
        }

        .meter-fill {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 0%;
            background: linear-gradient(to top, #0f0, #ff0, #f00);
            transition: height 0.1s;
        }

        /* Visualizers */
        .vis-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            height: 300px;
        }

        canvas {
            width: 100%;
            height: 100%;
            background: #000;
            border-radius: 15px;
            border: 1px solid #222;
        }

        .log-terminal {
            background: #000;
            color: #0f0;
            font-family: 'Courier New', monospace;
            padding: 20px;
            height: 200px;
            overflow-y: auto;
            border-radius: 15px;
            border: 1px solid #1a1a25;
            font-size: 0.85rem;
            line-height: 1.5;
        }

        .loading-overlay {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.9);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            backdrop-filter: blur(10px);
        }

        .matrix-loader {
            width: 80px;
            height: 80px;
            border: 4px solid transparent;
            border-top: 4px solid var(--neon-blue);
            border-right: 4px solid var(--neon-purple);
            border-radius: 50%;
            animation: spin 0.8s cubic-bezier(0.68, -0.55, 0.27, 1.55) infinite;
        }

        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        /* Song Structure Indicator */
        .structure-bar {
            display: flex;
            height: 40px;
            background: #111;
            border-radius: 10px;
            overflow: hidden;
            margin-top: 20px;
        }

        .structure-part {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            font-weight: bold;
            border-right: 1px solid rgba(255,255,255,0.1);
            transition: 0.3s;
        }

        .structure-part.active {
            background: var(--neon-blue);
            color: #000;
            box-shadow: inset 0 0 10px rgba(0,0,0,0.5);
        }
    </style>
</head>
<body>

<div class="loading-overlay" id="loaderOverlay">
    <div class="matrix-loader"></div>
    <h2 style="margin-top: 20px; letter-spacing: 2px;">Gemini ××¡× ×›×¨×Ÿ ×ª×“×¨×™×...</h2>
    <p id="loaderStatus">×× ×ª×— ×¡××•× ×“...</p>
</div>

<div class="studio-wrapper">
    <header>
        <h1>AI TRANCE STUDIO</h1>
        <p style="color: #888;">Professional Algorithmic Music Production Suite</p>
    </header>

    <div class="dashboard">
        <!-- Sidebar Controls -->
        <aside class="sidebar">
            <div class="input-group">
                <label>Gemini API Key</label>
                <input type="password" id="apiKey" placeholder="Paste your API key here...">
                <button class="btn btn-secondary" onclick="saveKey()" style="margin-top:10px; padding: 8px;">×©××•×¨ ××¤×ª×—</button>
            </div>

            <div class="input-group">
                <label>AI Prompt (Style & Mood)</label>
                <textarea id="prompt" placeholder="Describe the vibe: e.g., 'Dark Forest Psytrance with high-speed leads and organic atmosphere'"></textarea>
            </div>

            <div class="input-group">
                <label>Music Genre</label>
                <select id="genre">
                    <option value="progressive">Progressive Trance</option>
                    <option value="psytrance">Full-On Psytrance</option>
                    <option value="uplifting">Uplifting Trance</option>
                    <option value="techno">Hard Techno / Acid</option>
                    <option value="ambient">Deep Ambient Trance</option>
                </select>
            </div>

            <div class="input-group">
                <label>Complexity</label>
                <input type="range" id="complexity" min="1" max="10" value="7">
            </div>

            <button id="generateBtn" class="btn btn-primary" onclick="initiateAIGeneration()">
                <span>âš¡</span> ×¦×•×¨ ×¤×¨×•×™×§×˜ ×—×“×©
            </button>
            <button id="playBtn" class="btn btn-success" onclick="togglePlayback()" disabled>
                <span>â–¶</span> × ×’×Ÿ / ×”×©×”×”
            </button>
            <button id="downloadBtn" class="btn btn-secondary" onclick="downloadMix()" disabled>
                <span>ğŸ’¾</span> ×™×™×¦×•× WAV
            </button>
            <button class="btn btn-danger" onclick="emergencyStop()">
                <span>ğŸ›‘</span> ×¢×¦×™×¨×ª ×—×™×¨×•×
            </button>
        </aside>

        <!-- Main Studio Area -->
        <main class="main-stage">
            
            <div class="card vis-container">
                <div>
                    <label>Spectrogram (FFT)</label>
                    <canvas id="freqCanvas"></canvas>
                </div>
                <div>
                    <label>Waveform (Time Domain)</label>
                    <canvas id="waveCanvas"></canvas>
                </div>
            </div>

            <div class="card">
                <label>××‘× ×” ×”×©×™×¨ ×”××ª×•×›× ×Ÿ (Arrangement)</label>
                <div class="structure-bar" id="songStructure">
                    <!-- Dynamic segments -->
                    <div class="structure-part">Waiting for AI...</div>
                </div>
            </div>

            <div class="card">
                <label>Virtual Mixer (16 Channels Pro)</label>
                <div class="mixer-grid" id="mixerGrid">
                    <!-- Mixer strips will be generated by JS -->
                </div>
            </div>

            <div class="log-terminal" id="terminal">
                [SYSTEM READY] - ×‘×¨×•×š ×”×‘× ×œ-AI Trance Studio Pro.<br>
                ×”×–×Ÿ ××¤×ª×— API ×•×ª×™××•×¨ ××•×–×™×§×œ×™ ×›×“×™ ×œ×”×ª×—×™×œ ×‘×™×¦×™×¨×”...
            </div>
        </main>
    </div>
</div>

<script>
/**
 * AI TRANCE STUDIO PRO ENGINE v3.0
 * ×× ×•×¢ ×¡×™× ×ª×–×” ××ª×§×“× ××‘×•×¡×¡ Web Audio API
 */

// --- GLOBAL STATE ---
const API_URL = "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent";
let audioCtx, masterBus, recorder;
let isPlaying = false;
let currentBpm = 138;
let songParts = [];
let currentPartIndex = 0;
let stepCounter = 0;
let scheduleTimer;
let recordedChunks = [];

// Instrument definitions
const INSTRUMENTS = {
    KICK: { color: '#00f2ff', label: 'Kick' },
    SNARE: { color: '#bc13fe', label: 'Snare' },
    HIHAT: { color: '#39ff14', label: 'Hi-Hat' },
    PERC: { color: '#ffff00', label: 'Perc' },
    BASS: { color: '#ff0055', label: 'Sub Bass' },
    ACID: { color: '#00ffaa', label: 'Acid Line' },
    LEAD: { color: '#ffffff', label: 'Main Lead' },
    PLUCK: { color: '#ffaa00', label: 'Pluck' },
    PAD: { color: '#aa00ff', label: 'Atmosphere' },
    FX: { color: '#0055ff', label: 'SFX' }
};

const CHANNELS = {};

// --- UTILS ---

function addLog(msg, color = '#0f0') {
    const term = document.getElementById('terminal');
    const time = new Date().toLocaleTimeString();
    term.innerHTML += `<div style="color:${color}">[${time}] ${msg}</div>`;
    term.scrollTop = term.scrollHeight;
}

function saveKey() {
    const key = document.getElementById('apiKey').value;
    localStorage.setItem('gemini_api_key', key);
    addLog("API Key saved to local storage.", "#00f2ff");
}

window.onload = () => {
    const saved = localStorage.getItem('gemini_api_key');
    if(saved) document.getElementById('apiKey').value = saved;
    setupMixer();
};

// --- AUDIO ENGINE CORE ---

function setupMixer() {
    const grid = document.getElementById('mixerGrid');
    grid.innerHTML = '';
    
    Object.keys(INSTRUMENTS).forEach(key => {
        const inst = INSTRUMENTS[key];
        const strip = document.createElement('div');
        strip.className = 'mixer-strip';
        strip.innerHTML = `
            <div class="meter"><div id="meter-${key}" class="meter-fill"></div></div>
            <div class="fader-container">
                <input type="range" class="fader" id="vol-${key}" min="0" max="1.5" step="0.01" value="0.8">
            </div>
            <span style="font-size:0.7rem; color:${inst.color}">${inst.label}</span>
            <div id="led-${key}" style="width:10px; height:10px; background:#222; border-radius:50%"></div>
        `;
        grid.appendChild(strip);
        
        CHANNELS[key] = {
            gain: null,
            analyser: null,
            level: 0.8
        };
    });
}

async function initAudio() {
    if (audioCtx) return;
    audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    masterBus = audioCtx.createGain();
    
    const compressor = audioCtx.createDynamicsCompressor();
    compressor.threshold.value = -12;
    compressor.knee.value = 30;
    compressor.ratio.value = 12;
    compressor.attack.value = 0.003;
    compressor.release.value = 0.25;

    const masterAnalyser = audioCtx.createAnalyser();
    masterAnalyser.fftSize = 2048;

    masterBus.connect(compressor);
    compressor.connect(masterAnalyser);
    masterAnalyser.connect(audioCtx.destination);

    // Setup visualizer targets
    window.mainAnalyser = masterAnalyser;
    
    // Connect channels
    Object.keys(CHANNELS).forEach(key => {
        const gain = audioCtx.createGain();
        gain.gain.value = 0.8;
        const chanAnalyser = audioCtx.createAnalyser();
        
        gain.connect(chanAnalyser);
        chanAnalyser.connect(masterBus);
        
        CHANNELS[key].gain = gain;
        CHANNELS[key].analyser = chanAnalyser;
    });

    addLog("Audio Engine Initialized. Ready for synthesis.", "#bc13fe");
}

// --- SYNTHESIS MODELS (Pro Implementation) ---

class TranceSynth {
    static kick(time, duration = 0.5) {
        const ctx = audioCtx;
        const g = CHANNELS.KICK.gain;
        if(!g) return;

        const osc = ctx.createOscillator();
        const env = ctx.createGain();
        
        osc.frequency.setValueAtTime(150, time);
        osc.frequency.exponentialRampToValueAtTime(40, time + 0.1);
        
        env.gain.setValueAtTime(1, time);
        env.gain.exponentialRampToValueAtTime(0.001, time + duration);
        
        osc.connect(env);
        env.connect(g);
        
        osc.start(time);
        osc.stop(time + duration);
        this.flash('KICK');
    }

    static hihat(time, type = 'open') {
        const ctx = audioCtx;
        const g = CHANNELS.HIHAT.gain;
        const bufferSize = ctx.sampleRate * 0.1;
        const buffer = ctx.createBuffer(1, bufferSize, ctx.sampleRate);
        const data = buffer.getChannelData(0);
        for (let i = 0; i < bufferSize; i++) data[i] = Math.random() * 2 - 1;

        const source = ctx.createBufferSource();
        source.buffer = buffer;
        
        const filter = ctx.createBiquadFilter();
        filter.type = 'highpass';
        filter.frequency.value = 8000;
        
        const env = ctx.createGain();
        const dur = type === 'open' ? 0.2 : 0.05;
        env.gain.setValueAtTime(0.3, time);
        env.gain.exponentialRampToValueAtTime(0.001, time + dur);
        
        source.connect(filter);
        filter.connect(env);
        env.connect(g);
        
        source.start(time);
        this.flash('HIHAT');
    }

    static acid(freq, time, duration) {
        const ctx = audioCtx;
        const g = CHANNELS.ACID.gain;
        
        const osc = ctx.createOscillator();
        const filter = ctx.createBiquadFilter();
        const env = ctx.createGain();
        
        osc.type = 'sawtooth';
        osc.frequency.setValueAtTime(freq, time);
        
        filter.type = 'lowpass';
        filter.Q.value = 20;
        filter.frequency.setValueAtTime(400, time);
        filter.frequency.exponentialRampToValueAtTime(4000, time + 0.05);
        
        env.gain.setValueAtTime(0.4, time);
        env.gain.exponentialRampToValueAtTime(0.001, time + duration);
        
        osc.connect(filter);
        filter.connect(env);
        env.connect(g);
        
        osc.start(time);
        osc.stop(time + duration);
        this.flash('ACID');
    }

    static flash(key) {
        const led = document.getElementById(`led-${key}`);
        if(led) {
            led.style.background = INSTRUMENTS[key].color;
            led.style.boxShadow = `0 0 10px ${INSTRUMENTS[key].color}`;
            setTimeout(() => {
                led.style.background = '#222';
                led.style.boxShadow = 'none';
            }, 100);
        }
    }
}

// --- AI ORCHESTRATION ---

async function initiateAIGeneration() {
    const key = document.getElementById('apiKey').value;
    const prompt = document.getElementById('prompt').value;
    const genre = document.getElementById('genre').value;
    
    if(!key) return addLog("×©×’×™××”: ×—×¡×¨ ××¤×ª×— API", "#f44");
    
    document.getElementById('loaderOverlay').style.display = 'flex';
    document.getElementById('loaderStatus').innerText = "Gemini ××¤×™×§ ××ª ×”×˜×¨××§...";

    const systemPrompt = `You are a world-class Electronic Music Producer. 
    Generate a full Trance arrangement JSON. 
    Requirements:
    - bpm: 135-150
    - parts: Array of objects. Each object represents 16 steps (one bar).
    - Each part has: "name" (Intro, Build, Drop, etc.), "kick", "hihat", "bass", "acid", "lead" (arrays of 16).
    - Values for drums: 1 or 0.
    - Values for bass/acid/lead: MIDI frequency (Hz). 0 for silence.
    - Diversity: At least 8 unique parts to create a journey.
    - Scale: Use A Minor / C Major frequencies.
    - Format: ONLY JSON. No text.`;

    try {
        const response = await fetch(`${API_URL}?key=${key}`, {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({
                contents: [{ parts: [{ text: `Create a professional ${genre} track based on: ${prompt}` }] }],
                systemInstruction: { parts: [{ text: systemPrompt }] }
            })
        });

        const data = await response.json();
        const rawJson = data.candidates[0].content.parts[0].text.replace(/```json|```/g, '');
        const trackData = JSON.parse(rawJson);

        currentBpm = trackData.bpm;
        songParts = trackData.parts;
        
        renderStructure();
        await initAudio();
        
        document.getElementById('playBtn').disabled = false;
        addLog(`×¤×¨×•×™×§×˜ ×—×“×© × ×•×¦×¨! BPM: ${currentBpm}`, "#39ff14");
    } catch (e) {
        addLog("×©×’×™××” ×‘×ª×§×©×•×¨×ª ×¢× ×”-AI. × ×¡×” ×©× ×™×ª ××• ×‘×“×•×§ ××ª ×”××¤×ª×—.", "#f44");
        console.error(e);
    } finally {
        document.getElementById('loaderOverlay').style.display = 'none';
    }
}

function renderStructure() {
    const bar = document.getElementById('songStructure');
    bar.innerHTML = '';
    songParts.forEach((part, i) => {
        const div = document.createElement('div');
        div.className = 'structure-part';
        div.innerText = part.name;
        div.id = `part-${i}`;
        bar.appendChild(div);
    });
}

// --- SEQUENCER ---

function togglePlayback() {
    if(isPlaying) {
        stopSequencer();
    } else {
        startSequencer();
    }
}

function startSequencer() {
    isPlaying = true;
    currentPartIndex = 0;
    stepCounter = 0;
    
    const secondsPerStep = 60 / currentBpm / 4;
    let nextNoteTime = audioCtx.currentTime + 0.1;

    function schedule() {
        while (nextNoteTime < audioCtx.currentTime + 0.2) {
            playStep(nextNoteTime);
            nextNoteTime += secondsPerStep;
            advanceStep();
        }
        scheduleTimer = setTimeout(schedule, 25);
    }
    
    schedule();
    drawAll();
    addLog("Playback started.", "#39ff14");
}

function stopSequencer() {
    isPlaying = false;
    clearTimeout(scheduleTimer);
    addLog("Playback stopped.", "#f44");
}

function advanceStep() {
    stepCounter++;
    if(stepCounter >= 16) {
        stepCounter = 0;
        currentPartIndex++;
        if(currentPartIndex >= songParts.length) {
            currentPartIndex = 0;
        }
        updateStructureUI();
    }
}

function updateStructureUI() {
    document.querySelectorAll('.structure-part').forEach(p => p.classList.remove('active'));
    document.getElementById(`part-${currentPartIndex}`).classList.add('active');
}

function playStep(time) {
    const part = songParts[currentPartIndex];
    
    // Process Drums
    if(part.kick[stepCounter]) TranceSynth.kick(time);
    if(part.hihat[stepCounter]) TranceSynth.hihat(time, stepCounter % 4 === 2 ? 'open' : 'closed');
    
    // Process Synths
    if(part.acid[stepCounter] > 0) TranceSynth.acid(part.acid[stepCounter], time, 0.1);
    
    // Lead synthesis logic (simplified for stability)
    if(part.lead && part.lead[stepCounter] > 0) {
        const osc = audioCtx.createOscillator();
        const g = CHANNELS.LEAD.gain;
        const env = audioCtx.createGain();
        osc.type = 'square';
        osc.frequency.setValueAtTime(part.lead[stepCounter], time);
        env.gain.setValueAtTime(0.2, time);
        env.gain.exponentialRampToValueAtTime(0.001, time + 0.3);
        osc.connect(env);
        env.connect(g);
        osc.start(time);
        osc.stop(time + 0.3);
        TranceSynth.flash('LEAD');
    }
}

// --- VISUALIZATION ENGINE ---

function drawAll() {
    if(!isPlaying) return;
    requestAnimationFrame(drawAll);
    
    // Master Visualizers
    drawFrequency();
    drawWaveform();
    
    // Mixer Meters
    Object.keys(CHANNELS).forEach(key => {
        const chan = CHANNELS[key];
        if(!chan.analyser) return;
        const data = new Uint8Array(1);
        chan.analyser.getByteFrequencyData(data);
        const level = (data[0] / 255) * 100;
        document.getElementById(`meter-${key}`).style.height = `${level}%`;
        
        // Update live volume from fader
        const faderVal = document.getElementById(`vol-${key}`).value;
        chan.gain.gain.setTargetAtTime(faderVal, audioCtx.currentTime, 0.05);
    });
}

function drawFrequency() {
    const canvas = document.getElementById('freqCanvas');
    const ctx = canvas.getContext('2d');
    const bufferLength = window.mainAnalyser.frequencyBinCount;
    const dataArray = new Uint8Array(bufferLength);
    window.mainAnalyser.getByteFrequencyData(dataArray);

    canvas.width = canvas.offsetWidth;
    canvas.height = canvas.offsetHeight;
    ctx.fillStyle = '#000';
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    const barWidth = (canvas.width / bufferLength) * 2.5;
    let x = 0;

    for (let i = 0; i < bufferLength; i++) {
        const barHeight = (dataArray[i] / 255) * canvas.height;
        ctx.fillStyle = `hsl(${i / bufferLength * 360}, 100%, 50%)`;
        ctx.fillRect(x, canvas.height - barHeight, barWidth, barHeight);
        x += barWidth + 1;
    }
}

function drawWaveform() {
    const canvas = document.getElementById('waveCanvas');
    const ctx = canvas.getContext('2d');
    const bufferLength = window.mainAnalyser.fftSize;
    const dataArray = new Uint8Array(bufferLength);
    window.mainAnalyser.getByteTimeDomainData(dataArray);

    canvas.width = canvas.offsetWidth;
    canvas.height = canvas.offsetHeight;
    ctx.fillStyle = '#000';
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    ctx.lineWidth = 2;
    ctx.strokeStyle = '#00f2ff';
    ctx.beginPath();

    const sliceWidth = canvas.width / bufferLength;
    let x = 0;

    for (let i = 0; i < bufferLength; i++) {
        const v = dataArray[i] / 128.0;
        const y = v * canvas.height / 2;
        if (i === 0) ctx.moveTo(x, y);
        else ctx.lineTo(x, y);
        x += sliceWidth;
    }
    ctx.lineTo(canvas.width, canvas.height / 2);
    ctx.stroke();
}

function emergencyStop() {
    if(audioCtx) audioCtx.suspend();
    stopSequencer();
    addLog("EMERGENCY STOP ACTIVATED", "#f00");
}

function downloadMix() {
    addLog("×™×™×¦×•× ×”×§×•×‘×¥ ×¢×“×™×™×Ÿ ×‘×¤×™×ª×•×— ×‘×’×¨×¡×” ×–×•. ×”×©×ª××© ×‘×”×§×œ×˜×ª ×“×¤×“×¤×Ÿ ×‘×™× ×ª×™×™×.", "#ffaa00");
}

</script>
</body>
</html>
